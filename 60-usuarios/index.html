<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados de Pruebas - Sistema Q-Flow</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body{font-family:'Aptos','Segoe UI',Tahoma,Geneva,Verdana,sans-serif;line-height:1.4;margin:0;padding:10px;background-color:#f5f5f5;font-size:12px}
        .container{max-width:1400px;margin:0 auto;background:white;padding:15px;border-radius:8px;box-shadow:0 0 15px rgba(0,0,0,0.1)}
        .document-info{background:#f8f9fa;padding:15px;border-radius:6px;margin-bottom:20px;border-left:4px solid #1a237e}
        .document-info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;font-size:12px;color:#666}
        h1{color:#2c3e50;text-align:center;border-bottom:3px solid #3498db;padding-bottom:10px;margin-bottom:20px;font-size:24px}
        .subtitle{text-align:center;color:#7f8c8d;font-style:italic;margin-bottom:25px;font-size:14px}
        h2{color:#34495e;margin-top:20px;margin-bottom:10px;border-left:3px solid #3498db;padding-left:12px;font-size:16px}
        h3{color:#34495e;margin-top:15px;margin-bottom:8px;font-size:14px}
        .test-summary{background:linear-gradient(135deg,#2c3e50 0%,#34495e 100%);color:white;padding:12px;border-radius:6px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center}
        .test-summary-content{flex:1}
        .test-summary h3{margin-top:0;margin-bottom:5px;font-size:16px;color:#ecf0f1}
        .test-summary p{margin:0;font-size:12px}
        .result-badge{background:#e74c3c;color:white;padding:15px 20px;border-radius:6px;font-weight:bold;font-size:18px;text-align:center;min-width:80px;height:50px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,0.2)}
        .results-table{width:100%;border-collapse:collapse;margin:10px 0;font-size:10px}
        .results-table th,.results-table td{border:1px solid #ddd;padding:6px 4px;text-align:center}
        .results-table th{background:linear-gradient(135deg,#3498db,#2980b9);color:white;font-weight:bold}
        .results-table tr:nth-child(even){background-color:#f9f9f9}
        .fail{background-color:#e74c3c;color:white;padding:5px 10px;border-radius:15px;font-weight:bold}
        .chart-container-three{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:15px 0}
        .chart-box{background:white;padding:10px;border-radius:6px;box-shadow:0 1px 5px rgba(0,0,0,0.1);height:200px}
        .chart-box canvas{max-height:150px!important;max-width:100%!important}
        .chart-title{text-align:center;color:#2c3e50;margin-bottom:8px;font-weight:bold;font-size:11px}
        .metrics-grid{display:grid;grid-template-columns:repeat(4,1fr) 150px;gap:10px;margin:15px 0;align-items:center}
        .metric-card{background:linear-gradient(135deg,#ffccd5 0%,#ffb3ba 100%);color:#c0392b;padding:10px;border-radius:6px;text-align:center}
        .metric-value{font-size:1.4em;font-weight:bold;margin-bottom:3px}
        .metric-label{font-size:0.8em;opacity:0.9}
        .pie-chart-container{display:flex;flex-direction:column;align-items:center;background:white;padding:10px;border-radius:6px;box-shadow:0 1px 5px rgba(0,0,0,0.1)}
        .pie-chart-title{font-size:10px;font-weight:bold;color:#2c3e50;margin-bottom:5px}
        .pie-chart-container canvas{max-height:100px!important;max-width:100px!important}
        .architecture-info{background:#ecf0f1;padding:12px;border-radius:6px;margin:15px 0;font-size:11px}
        .critical-warning{background:#ffebee;border:2px solid #e74c3c;padding:12px;border-radius:6px;margin:15px 0;font-size:11px}
        .server-info{display:flex;justify-content:space-between;gap:15px;margin:10px 0}
        .server-box{flex:1;background:white;padding:10px;border-radius:6px;border-left:3px solid #3498db}
        .server-box h4{margin-top:0;margin-bottom:8px;font-size:12px}
        .server-box ul{margin:0;padding-left:15px}
        .server-box li{font-size:10px;margin-bottom:2px}
        .legend{display:flex;justify-content:center;gap:15px;margin:10px 0;flex-wrap:wrap}
        .legend-item{display:flex;align-items:center;gap:5px;font-size:10px}
        .legend-color{width:15px;height:15px;border-radius:2px}
        
        /* Bot√≥n de navegaci√≥n */
        .nav-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:10px 0;border-bottom:1px solid #e0e0e0}
        .back-btn{background:linear-gradient(135deg,#3498db,#2980b9);color:white;padding:8px 16px;border:none;border-radius:6px;font-size:12px;font-weight:bold;cursor:pointer;display:flex;align-items:center;gap:8px;text-decoration:none;transition:all 0.3s ease}
        .back-btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(52,152,219,0.3);text-decoration:none;color:white}
        .back-btn:active{transform:translateY(0)}
        .page-title{color:#2c3e50;font-size:14px;font-weight:bold;margin:0}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header de navegaci√≥n -->
        <div class="nav-header">
            <button class="back-btn" onclick="goBack()">
                <span>‚Üê</span>
                <span>Regresar</span>
            </button>
            <div class="page-title">Reporte de Performance - 60 Usuarios Concurrentes (FAIL)</div>
        </div>
        <div class="document-info">
            <div class="document-info-grid">
                <div><strong>Fecha de Elaboraci√≥n:</strong> 30 de Mayo, 2025</div>
                <div><strong>Entorno:</strong> QA-DESA</div>
                <div><strong>Cliente:</strong> BBVA Mex</div>
                <div><strong>Modalidad:</strong> Script Info Page Activo</div>
            </div>
        </div>

        <h1>An√°lisis de Capacidad Sistema Q-Flow - Entorno QA-DESA</h1>
        <p class="subtitle">Evaluaci√≥n Completa de Rendimiento: 60 Usuarios Concurrentes<br><strong>Script Info Page(1) Activo</strong></p>

        <div class="test-summary">
            <div class="test-summary-content">
                <h3>Prueba BBVAReceptionConsole006 - Performance (60 Usuarios Concurrentes)</h3>
                <p><strong>Duraci√≥n:</strong> 8 minutos | <strong>Arquitectura:</strong> Q-Flow + IIS + SQL Server</p>
            </div>
            <div class="result-badge">FAIL</div>
        </div>

        <div class="critical-warning">
            <h4 style="color:#c0392b;margin-top:0">‚ö†Ô∏è ALERTA CR√çTICA: L√çMITE DE INFRAESTRUCTURA ALCANZADO</h4>
            <p><strong>El servidor de QA-DESA ha superado su capacidad operacional. Esta prueba confirma el l√≠mite m√°ximo de 48 usuarios concurrentes para esta infraestructura espec√≠fica de QA-DESA.</strong></p>
        </div>

        <div class="architecture-info">
            <h3>üíª Especificaciones de Infraestructura QA-DESA</h3>
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin:15px 0">
                <div style="background:white;padding:15px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.1)">
                    <h4 style="margin-top:0;color:#e74c3c;font-size:13px">SQL Server (BBVAMX-UATSQL1)</h4>
                    <ul style="font-size:10px;margin:0;padding-left:15px">
                        <li><strong>OS:</strong> Windows Server 2022 Datacenter</li>
                        <li><strong>CPU:</strong> AMD EPYC 7763 64-Core (2 Core, 4 Logical)</li>
                        <li><strong>RAM:</strong> 7.95 GB Total (2.07 GB Disponible)</li>
                        <li><strong>Virtualizaci√≥n:</strong> Hyper-V Virtual Machine</li>
                    </ul>
                </div>
                <div style="background:white;padding:15px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.1)">
                    <h4 style="margin-top:0;color:#27ae60;font-size:13px">IIS Server 1 (BBVAMX-UATIIS1)</h4>
                    <ul style="font-size:10px;margin:0;padding-left:15px">
                        <li><strong>OS:</strong> Windows Server 2022 Datacenter</li>
                        <li><strong>CPU:</strong> AMD EPYC 7763 64-Core (2 Core, 4 Logical)</li>
                        <li><strong>RAM:</strong> 7.95 GB Total (3.38 GB Disponible)</li>
                        <li><strong>Rol:</strong> Web Services Q-Flow</li>
                    </ul>
                </div>
                <div style="background:white;padding:15px;border-radius:6px;box-shadow:0 2px 4px rgba(0,0,0,0.1)">
                    <h4 style="margin-top:0;color:#3498db;font-size:13px">IIS Server 2 (BBVAMX-UATIIS2)</h4>
                    <ul style="font-size:10px;margin:0;padding-left:15px">
                        <li><strong>OS:</strong> Windows Server 2022 Datacenter</li>
                        <li><strong>CPU:</strong> AMD EPYC 7763 64-Core (2 Core, 4 Logical)</li>
                        <li><strong>RAM:</strong> 7.95 GB Total (4.49 GB Disponible)</li>
                        <li><strong>Rol:</strong> Web Services Q-Flow</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="architecture-info">
            <h3>Arquitectura del Sistema</h3>
            <div class="server-info">
                <div class="server-box">
                    <h4>IIS Server 1</h4>
                    <ul><li>Servicios Web Q-Flow</li><li>Web de Encolamiento</li><li>Balanceador de Carga</li></ul>
                </div>
                <div class="server-box">
                    <h4>IIS Server 2</h4>
                    <ul><li>Servicios Web Q-Flow</li><li>Web de Encolamiento</li><li>Balanceador de Carga</li></ul>
                </div>
                <div class="server-box">
                    <h4>SQL Server</h4>
                    <ul><li>Base de Datos Q-Flow</li><li>Almacenamiento de Transacciones</li><li>Gesti√≥n de Colas</li></ul>
                </div>
            </div>
        </div>

        <h2>Resultados Consolidados</h2>
        <table class="results-table">
            <thead>
                <tr>
                    <th>Prueba</th><th>Concurrencia</th><th>Duraci√≥n</th><th>Muestras</th><th>Errores</th><th>% Error</th><th>Tiempo Prom (ms)</th><th>Min (ms)</th><th>Max (ms)</th><th>Std. Dev.</th><th>Throughput (TPS)</th><th>Resultado</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>BBVAReceptionConsole006</strong></td><td>60 usuarios</td><td>8 min</td><td>18,736</td><td>2,862</td><td>15.29%</td><td>994</td><td>0</td><td>20463</td><td>---</td><td>39.8</td><td><span class="fail">FAIL</span></td>
                </tr>
            </tbody>
        </table>

        <h2>M√©tricas Clave</h2>
        <div class="metrics-grid">
            <div class="metric-card"><div class="metric-value">39.8</div><div class="metric-label">Transacciones/seg</div></div>
            <div class="metric-card"><div class="metric-value">15.29%</div><div class="metric-label">Tasa de Error</div></div>
            <div class="metric-card"><div class="metric-value">994ms</div><div class="metric-label">Tiempo Promedio</div></div>
            <div class="metric-card"><div class="metric-value">20463ms</div><div class="metric-label">M√°ximo</div></div>
            <div class="pie-chart-container">
                <div class="pie-chart-title">Resultado</div>
                <canvas id="resultPieChart" width="100" height="100"></canvas>
            </div>
        </div>

        <h2>Rendimiento de Hardware</h2>
        <div class="legend">
            <div class="legend-item"><div class="legend-color" style="background-color:#ff6b6b"></div><span>Memoria</span></div>
            <div class="legend-item"><div class="legend-color" style="background-color:#f9ca24"></div><span>CPU</span></div>
            <div class="legend-item"><div class="legend-color" style="background-color:#4ecdc4"></div><span>Disco C: (S.O.)</span></div>
            <div class="legend-item"><div class="legend-color" style="background-color:#9b59b6"></div><span>Disco N: (Web/IIS)</span></div>
            <div class="legend-item"><div class="legend-color" style="background-color:#27ae60"></div><span>Disco G: (Q-Flow Data)</span></div>
        </div>

        <h3>Uso de CPU y Memoria</h3>
        <div class="chart-container-three">
            <div class="chart-box"><div class="chart-title">IIS Server 1 - CPU y Memoria</div><canvas id="s1cpu"></canvas></div>
            <div class="chart-box"><div class="chart-title">IIS Server 2 - CPU y Memoria</div><canvas id="s2cpu"></canvas></div>
            <div class="chart-box"><div class="chart-title">SQL Server - CPU y Memoria</div><canvas id="sqlcpu"></canvas></div>
        </div>

        <h3>Uso de Discos (I/O)</h3>
        <div class="chart-container-three">
            <div class="chart-box"><div class="chart-title">IIS Server 1 - Discos C: y N:</div><canvas id="s1disk"></canvas></div>
            <div class="chart-box"><div class="chart-title">IIS Server 2 - Discos C: y N:</div><canvas id="s2disk"></canvas></div>
            <div class="chart-box"><div class="chart-title">SQL Server - Discos C: y G:</div><canvas id="sqldisk"></canvas></div>
        </div>

        <h2>An√°lisis de Rendimiento</h2>
        <div class="architecture-info">
            <h4>Observaciones Cr√≠ticas:</h4>
            <ul>
                <li><strong>L√≠mite de Infraestructura:</strong> 15.29% de errores marca el l√≠mite del servidor de QA-DESA</li>
                <li><strong>Degradaci√≥n por Hardware:</strong> Ca√≠da del 28% en throughput (55.2 ‚Üí 39.8 TPS)</li>
                <li><strong>Latencia por Recursos:</strong> Tiempo promedio aument√≥ 162% (379ms ‚Üí 994ms)</li>
                <li><strong>Picos de Servidor Limitado:</strong> Tiempo m√°ximo de 20.4 segundos vs 6.6s anterior</li>
                <li><strong>SQL Server QA Saturado:</strong> CPU sostenido al 80-100% - l√≠mite de hardware</li>
                <li><strong>Memoria de QA al L√≠mite:</strong> Picos constantes por especificaciones reducidas</li>
                <li><strong>Capacidad de Servidor Confirmada:</strong> 48 usuarios m√°ximos para esta infraestructura QA</li>
                <li><strong>Q-Flow Sistema Robusto:</strong> El software maneja la carga; hardware es el limitante</li>
            </ul>
        </div>

        <div class="critical-warning">
            <h4 style="color:#c0392b;margin-top:0">üö® CONCLUSI√ìN: L√çMITE DE INFRAESTRUCTURA DE QA-DESA</h4>
            <p><strong>Esta prueba demuestra que el servidor de QA-DESA alcanz√≥ su l√≠mite de infraestructura con 60 usuarios concurrentes. Q-Flow como sistema es capaz de manejar mayor carga en servidores de mayor capacidad. El l√≠mite operacional para este entorno QA-DESA espec√≠fico se establece en 48 usuarios concurrentes m√°ximo.</strong></p>
        </div>
    </div>

<script>
window.addEventListener('load', function() {
    if (typeof Chart === 'undefined') return;
    
    const t = ['5:07', '5:09', '5:11', '5:13', '5:15', '5:16'];
    const s1 = {cpu: [28, 35, 52, 45, 38, 42], mem: [22, 28, 38, 42, 35, 32], dc: [5, 8, 15, 18, 12, 10], dn: [20, 28, 45, 52, 38, 35]};
    const s2 = {cpu: [26, 32, 48, 42, 36, 40], mem: [20, 26, 36, 40, 33, 30], dc: [4, 7, 13, 16, 11, 9], dn: [18, 26, 42, 48, 36, 33]};
    const sql = {cpu: [85, 92, 98, 95, 88, 90], mem: [65, 72, 80, 85, 78, 75], dc: [12, 18, 25, 22, 18, 15], dg: [45, 62, 85, 92, 75, 68]};
    
    const opt = {responsive: true, maintainAspectRatio: true, aspectRatio: 2, plugins: {legend: {display: true, position: 'top', labels: {font: {size: 9}, boxWidth: 10, padding: 8}}}, scales: {y: {beginAtZero: true, max: 100, title: {display: true, text: 'Uso (%)', font: {size: 10}}, ticks: {font: {size: 9}}}, x: {title: {display: true, text: 'Tiempo', font: {size: 10}}, ticks: {font: {size: 9}}}}};
    
    function cc(id, cfg) {
        try {
            const el = document.getElementById(id);
            if (!el) return null;
            return new Chart(el, cfg);
        } catch (e) {
            console.error('Error:', e);
            return null;
        }
    }
    
    cc('resultPieChart', {type: 'pie', data: {labels: ['PASS (84.71%)', 'FAIL (15.29%)'], datasets: [{data: [84.71, 15.29], backgroundColor: ['#2ecc71', '#e74c3c'], borderWidth: 2, borderColor: '#ffffff'}]}, options: {responsive: true, maintainAspectRatio: true, plugins: {legend: {display: true, position: 'bottom', labels: {font: {size: 8}, boxWidth: 8, padding: 4, usePointStyle: true}}}}});
    
    cc('s1cpu', {type: 'line', data: {labels: t, datasets: [{label: 'CPU', data: s1.cpu, borderColor: '#f9ca24', backgroundColor: 'rgba(249, 202, 36, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Memoria', data: s1.mem, borderColor: '#ff6b6b', backgroundColor: 'rgba(255, 107, 107, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    cc('s2cpu', {type: 'line', data: {labels: t, datasets: [{label: 'CPU', data: s2.cpu, borderColor: '#f9ca24', backgroundColor: 'rgba(249, 202, 36, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Memoria', data: s2.mem, borderColor: '#ff6b6b', backgroundColor: 'rgba(255, 107, 107, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    cc('sqlcpu', {type: 'line', data: {labels: t, datasets: [{label: 'CPU', data: sql.cpu, borderColor: '#f9ca24', backgroundColor: 'rgba(249, 202, 36, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Memoria', data: sql.mem, borderColor: '#ff6b6b', backgroundColor: 'rgba(255, 107, 107, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    cc('s1disk', {type: 'line', data: {labels: t, datasets: [{label: 'Disco C: (S.O.)', data: s1.dc, borderColor: '#4ecdc4', backgroundColor: 'rgba(78, 205, 196, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Disco N: (Web/IIS)', data: s1.dn, borderColor: '#9b59b6', backgroundColor: 'rgba(155, 89, 182, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    cc('s2disk', {type: 'line', data: {labels: t, datasets: [{label: 'Disco C: (S.O.)', data: s2.dc, borderColor: '#4ecdc4', backgroundColor: 'rgba(78, 205, 196, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Disco N: (Web/IIS)', data: s2.dn, borderColor: '#9b59b6', backgroundColor: 'rgba(155, 89, 182, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    cc('sqldisk', {type: 'line', data: {labels: t, datasets: [{label: 'Disco C: (S.O.)', data: sql.dc, borderColor: '#4ecdc4', backgroundColor: 'rgba(78, 205, 196, 0.1)', tension: 0.4, borderWidth: 2}, {label: 'Disco G: (Q-Flow Data)', data: sql.dg, borderColor: '#27ae60', backgroundColor: 'rgba(39, 174, 96, 0.1)', tension: 0.4, borderWidth: 2}]}, options: opt});
    
    console.log('‚ö†Ô∏è Gr√°ficos 60 usuarios (FAIL) cargados!');
});

// Funci√≥n de navegaci√≥n para SharePoint
function goBack() {
    if (window.history.length > 1) {
        window.history.back();
    } else {
        window.location.href = '../index.html';
    }
}

// Tambi√©n funciona con tecla Escape
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        goBack();
    }
});
</script>
</body>
</html>
